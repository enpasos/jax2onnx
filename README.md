# jax2onnx üåü

`jax2onnx` converts your JAX/Flax functions directly into the ONNX format.

**Key features:**

- **JAXPR-Based Conversion:** Uses JAX's built-in `jaxpr` as the foundation for conversion.
- **Flexible Plugin System:** Easy-to-write Python plugins to handle specific JAX primitives or examples. Plugin registration and testing is automated.

![img.png](https://enpasos.github.io/jax2onnx/images/img1.png)

---

## üöÄ Quickstart

Here's how simple it is to convert your JAX callable to ONNX:

```python
from jax2onnx import save_onnx
from flax import nnx
import jax.numpy as jnp

# Example: A minimal MLP (from Flax documentation)
class MLP(nnx.Module):
  def __init__(self, din, dmid, dout, *, rngs):
    self.linear1 = nnx.Linear(din, dmid, rngs=rngs)
    self.dropout = nnx.Dropout(rate=0.1, rngs=rngs)
    self.bn = nnx.BatchNorm(dmid, rngs=rngs)
    self.linear2 = nnx.Linear(dmid, dout, rngs=rngs)
  def __call__(self, x):
    x = nnx.gelu(self.dropout(self.bn(self.linear1(x))))
    return self.linear2(x)

# Instantiate model
my_callable = MLP(din=30, dmid=20, dout=10, rngs=nnx.Rngs(0))

# Convert and save to ONNX
save_onnx(
    my_callable,
    [('B', 30)],          # Input shapes, batch size 'B' is symbolic
    "my_callable.onnx"    # Output path
)
```

---

## ‚ùì Troubleshooting

If conversion doesn't work out of the box, it could be due to:

- **Non-dynamic function references:**  
  JAXPR-based conversion requires function references to be resolved dynamically at call-time.  
  **Solution:** Wrap your function call inside a lambda to enforce dynamic resolution:
  ```python
  my_dynamic_callable_function = lambda x: original_function(x)
  ```

- **Unsupported primitives:**  
  The callable may use a primitive not yet or not fully supported by `jax2onnx`.  
  **Solution:** Write a [plugin](#how-to-contribute) to handle the unsupported function (this is straightforward!).

---

## üß© Supported JAX/ONNX Components

üöß **Table under construction**

<!-- AUTOGENERATED TABLE START -->

| JAX Component | ONNX Components | Testcases | Since |
|:-------------|:---------------|:---------|:------|
| [jnp.add](https://jax.readthedocs.io/en/latest/_autosummary/jax.numpy.add.html) | [Add](https://onnx.ai/onnx/operators/onnx__Add.html) | `jnp.add` [‚ûñ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/jnp/jnp.add.onnx) | v0.1.0 |
| [jnp.concat](https://docs.jax.dev/en/latest/_autosummary/jax.numpy.concat.html) | [Concat](https://onnx.ai/onnx/operators/onnx__Concat.html) | `jnp.concat` [‚ûñ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/jnp/jnp.concat.onnx) | v0.1.0 |
| [jnp.einsum](https://jax.readthedocs.io/en/latest/_autosummary/jax.numpy.einsum.html) | [Einsum](https://onnx.ai/onnx/operators/onnx__Einsum.html) | `jnp.einsum_dynamic_matmul2` [‚ûñ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/jnp/jnp.einsum_dynamic_matmul2.onnx)<br>`jnp.einsum_dynamic_matmul3` [‚ûñ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/jnp/jnp.einsum_dynamic_matmul3.onnx)<br>`jnp.einsum_dynamic_matmul` [‚ûñ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/jnp/jnp.einsum_dynamic_matmul.onnx)<br>`jnp.einsum_dynamic_transpose` [‚ûñ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/jnp/jnp.einsum_dynamic_transpose.onnx)<br>`jnp.einsum_dynamic` [‚ûñ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/jnp/jnp.einsum_dynamic.onnx)<br>`jnp.einsum_matmul` [‚ûñ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/jnp/jnp.einsum_matmul.onnx)<br>`jnp.einsum_transpose` [‚ûñ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/jnp/jnp.einsum_transpose.onnx)<br>`jnp.einsum` [‚ûñ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/jnp/jnp.einsum.onnx) | v0.1.0 |
| [jnp.matmul](https://jax.readthedocs.io/en/latest/_autosummary/jax.numpy.matmul.html) | [MatMul](https://onnx.ai/onnx/operators/onnx__MatMul.html) | `jnp.matmul_1d_2d` [‚ûñ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/jnp/jnp.matmul_1d_2d.onnx)<br>`jnp.matmul_1d` [‚ûñ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/jnp/jnp.matmul_1d.onnx)<br>`jnp.matmul_2d_1d` [‚ûñ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/jnp/jnp.matmul_2d_1d.onnx)<br>`jnp.matmul_2d` [‚ûñ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/jnp/jnp.matmul_2d.onnx)<br>`jnp.matmul_3d` [‚ûñ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/jnp/jnp.matmul_3d.onnx)<br>`jnp.matmul_dynamic_a` [‚ûñ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/jnp/jnp.matmul_dynamic_a.onnx)<br>`jnp.matmul_dynamic_b` [‚ûñ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/jnp/jnp.matmul_dynamic_b.onnx)<br>`jnp.matmul_dynamic` [‚ûñ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/jnp/jnp.matmul_dynamic.onnx) | v0.1.0 |
| [jnp.reshape](https://jax.readthedocs.io/en/latest/_autosummary/jax.numpy.reshape.html) | [Reshape](https://onnx.ai/onnx/operators/onnx__Reshape.html) | `jnp.reshape_1` [‚ûñ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/jnp/jnp.reshape_1.onnx)<br>`jnp.reshape_2` [‚ûñ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/jnp/jnp.reshape_2.onnx)<br>`jnp.reshape_3` [‚ûñ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/jnp/jnp.reshape_3.onnx)<br>`jnp.reshape_4` [‚ûñ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/jnp/jnp.reshape_4.onnx)<br>`jnp.reshape_from_scalar` [‚ûñ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/jnp/jnp.reshape_from_scalar.onnx)<br>`jnp.reshape_to_scalar` [‚ûñ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/jnp/jnp.reshape_to_scalar.onnx) | v0.1.0 |
| [jnp.squeeze](https://jax.readthedocs.io/en/latest/_autosummary/jax.numpy.squeeze.html) | [Squeeze](https://onnx.ai/onnx/operators/onnx__Squeeze.html) | <br><br>`squeeze_all_dims` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/jnp/squeeze_all_dims.onnx)<br>`squeeze_dynamic_and_negative_axis_concrete` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/jnp/squeeze_dynamic_and_negative_axis_concrete.onnx)<br>`squeeze_dynamic_and_negative_axis_dynamic` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/jnp/squeeze_dynamic_and_negative_axis_dynamic.onnx)<br>`squeeze_dynamic_batch_concrete` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/jnp/squeeze_dynamic_batch_concrete.onnx)<br>`squeeze_dynamic_batch_dynamic` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/jnp/squeeze_dynamic_batch_dynamic.onnx)<br>`squeeze_multiple_dims` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/jnp/squeeze_multiple_dims.onnx)<br>`squeeze_negative_axis_tuple` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/jnp/squeeze_negative_axis_tuple.onnx)<br>`squeeze_negative_axis` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/jnp/squeeze_negative_axis.onnx)<br>`squeeze_single_dim` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/jnp/squeeze_single_dim.onnx)<br>`squeeze_vit_output` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/jnp/squeeze_vit_output.onnx) | v0.1.0 |
| [jnp.tile](https://jax.readthedocs.io/en/latest/_autosummary/jax.numpy.tile.html) | [Tile](https://onnx.ai/onnx/operators/onnx__Tile.html) | <br>`tile_a` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/jnp/tile_a.onnx)<br>`tile_b` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/jnp/tile_b.onnx)<br>`tile_c` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/jnp/tile_c.onnx)<br>`tile_d` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/jnp/tile_d.onnx)<br>`tile_dynamic_concrete` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/jnp/tile_dynamic_concrete.onnx)<br>`tile_dynamic_dynamic` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/jnp/tile_dynamic_dynamic.onnx)<br>`tile_pad` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/jnp/tile_pad.onnx) | v0.1.0 |
| [jnp.transpose](https://jax.readthedocs.io/en/latest/_autosummary/jax.numpy.transpose.html) | [Transpose](https://onnx.ai/onnx/operators/onnx__Transpose.html) | <br>`transpose_4d` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/jnp/transpose_4d.onnx)<br>`transpose_basic` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/jnp/transpose_basic.onnx)<br>`transpose_dynamic_concrete` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/jnp/transpose_dynamic_concrete.onnx)<br>`transpose_dynamic_dynamic` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/jnp/transpose_dynamic_dynamic.onnx)<br>`transpose_high_dim` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/jnp/transpose_high_dim.onnx)<br>`transpose_no_axes` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/jnp/transpose_no_axes.onnx)<br>`transpose_reverse` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/jnp/transpose_reverse.onnx)<br>`transpose_square_matrix` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/jnp/transpose_square_matrix.onnx) | v0.1.0 |
| [lax.add](https://docs.jax.dev/en/latest/_autosummary/jax.lax.add.html) | [Add](https://onnx.ai/onnx/operators/onnx__Add.html) | `add` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/lax/add.onnx) | v0.2.0 |
| [lax.argmax](https://docs.jax.dev/en/latest/_autosummary/jax.lax.argmax.html) | [ArgMax](https://onnx.ai/onnx/operators/onnx__ArgMax.html) | `argmax_test1` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/lax/argmax_test1.onnx)<br>`argmax_test2` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/lax/argmax_test2.onnx) | v0.2.0 |
| [lax.argmin](https://docs.jax.dev/en/latest/_autosummary/jax.lax.argmin.html) | [ArgMin](https://onnx.ai/onnx/operators/onnx__ArgMin.html) | `argmin_test1` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/lax/argmin_test1.onnx)<br>`argmin_test2` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/lax/argmin_test2.onnx) | v0.2.0 |
| [lax.broadcast_in_dim](https://docs.jax.dev/en/latest/_autosummary/jax.lax.broadcast_in_dim.html) | [Expand](https://onnx.ai/onnx/operators/onnx__Expand.html) | `broadcast_in_dim` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/lax/broadcast_in_dim.onnx) | v0.2.0 |
| [lax.concatenate](https://docs.jax.dev/en/latest/_autosummary/jax.lax.concatenate.html) | [Concat](https://onnx.ai/onnx/operators/onnx__Concat.html) | `concatenate` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/lax/concatenate.onnx) | v0.2.0 |
| [lax.conv](https://docs.jax.dev/en/latest/_autosummary/jax.lax.conv.html) | [Conv](https://onnx.ai/onnx/operators/onnx__Conv.html) | `conv2` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/lax/conv2.onnx)<br>`conv` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/lax/conv.onnx) | v0.2.0 |
| [lax.convert_element_type](https://docs.jax.dev/en/latest/_autosummary/jax.lax.convert_element_type.html) | [Cast](https://onnx.ai/onnx/operators/onnx__Cast.html) | `convert_element_type` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/lax/convert_element_type.onnx) | v0.2.0 |
| [lax.div](https://docs.jax.dev/en/latest/_autosummary/jax.lax.div.html) | [Div](https://onnx.ai/onnx/operators/onnx__Div.html) | `div` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/lax/div.onnx) | v0.2.0 |
| [lax.dot_general](https://docs.jax.dev/en/latest/_autosummary/jax.lax.dot_general.html) | [MatMul](https://onnx.ai/onnx/operators/onnx__MatMul.html) | `dot_general` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/lax/dot_general.onnx) | v0.2.0 |
| [lax.dynamic_slice](https://docs.jax.dev/en/latest/_autosummary/jax.lax.dynamic_slice.html) | [Slice](https://onnx.ai/onnx/operators/onnx__Slice.html) | `dynamic_slice_test1` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/lax/dynamic_slice_test1.onnx) | v0.1.0 |
| [lax.eq](https://docs.jax.dev/en/latest/_autosummary/jax.lax.eq.html) | [Equal](https://onnx.ai/onnx/operators/onnx__Equal.html) | `eq` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/lax/eq.onnx) | v0.2.0 |
| [lax.exp](https://docs.jax.dev/en/latest/_autosummary/jax.lax.exp.html) | [Exp](https://onnx.ai/onnx/operators/onnx__Exp.html) | `exp` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/lax/exp.onnx) | v0.2.0 |
| [lax.gather](https://docs.jax.dev/en/latest/_autosummary/jax.lax.gather.html) | [Gather](https://onnx.ai/onnx/operators/onnx__Gather.html) | `gather` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/lax/gather.onnx) | v0.2.0 |
| [lax.gt](https://docs.jax.dev/en/latest/_autosummary/jax.lax.gt.html) | [Greater](https://onnx.ai/onnx/operators/onnx__Greater.html) | `gt` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/lax/gt.onnx) | v0.2.0 |
| [lax.integer_pow](https://docs.jax.dev/en/latest/_autosummary/jax.lax.integer_pow.html) | [Pow](https://onnx.ai/onnx/operators/onnx__Pow.html) | `integer_pow` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/lax/integer_pow.onnx) | v0.2.0 |
| [lax.log](https://docs.jax.dev/en/latest/_autosummary/jax.lax.log.html) | [Log](https://onnx.ai/onnx/operators/onnx__Log.html) | `log` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/lax/log.onnx) | v0.2.0 |
| [lax.lt](https://docs.jax.dev/en/latest/_autosummary/jax.lax.lt.html) | [Less](https://onnx.ai/onnx/operators/onnx__Less.html) | `lt` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/lax/lt.onnx) | v0.2.0 |
| [lax.max](https://docs.jax.dev/en/latest/_autosummary/jax.lax.max.html) | [Max](https://onnx.ai/onnx/operators/onnx__Max.html) | `max` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/lax/max.onnx) | v0.2.0 |
| [lax.min](https://docs.jax.dev/en/latest/_autosummary/jax.lax.min.html) | [Min](https://onnx.ai/onnx/operators/onnx__Min.html) | `min_test1` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/lax/min_test1.onnx) | v0.1.0 |
| [lax.mul](https://docs.jax.dev/en/latest/_autosummary/jax.lax.mul.html) | [Mul](https://onnx.ai/onnx/operators/onnx__Mul.html) | `mul_test1` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/lax/mul_test1.onnx)<br>`mul_test2` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/lax/mul_test2.onnx) | v0.1.0 |
| [lax.ne](https://docs.jax.dev/en/latest/_autosummary/jax.lax.ne.html) | [NotEqual](https://onnx.ai/onnx/operators/onnx__NotEqual.html) | `ne` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/lax/ne.onnx) | v0.2.0 |
| [lax.neg](https://docs.jax.dev/en/latest/_autosummary/jax.lax.neg.html) | [Neg](https://onnx.ai/onnx/operators/onnx__Neg.html) | `neg` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/lax/neg.onnx) | v0.2.0 |
| [lax.reduce_max](https://docs.jax.dev/en/latest/_autosummary/jax.lax.reduce_max.html) | [ReduceMax](https://onnx.ai/onnx/operators/onnx__ReduceMax.html) | `reduce_max` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/lax/reduce_max.onnx) | v0.2.0 |
| [lax.reduce_min](https://docs.jax.dev/en/latest/_autosummary/jax.lax.reduce_min.html) | [ReduceMin](https://onnx.ai/onnx/operators/onnx__ReduceMin.html) | `reduce_min` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/lax/reduce_min.onnx) | v0.2.0 |
| [lax.reduce_sum](https://docs.jax.dev/en/latest/_autosummary/jax.lax.reduce_sum.html) | [ReduceSum](https://onnx.ai/onnx/operators/onnx__ReduceSum.html) | `reduce_sum` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/lax/reduce_sum.onnx) | v0.2.0 |
| [lax.reshape](https://docs.jax.dev/en/latest/_autosummary/jax.lax.reshape.html) | [Reshape](https://onnx.ai/onnx/operators/onnx__Reshape.html) | `reshape` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/lax/reshape.onnx) | v0.2.0 |
| [lax.slice](https://docs.jax.dev/en/latest/_autosummary/jax.lax.slice.html) | [Slice](https://onnx.ai/onnx/operators/onnx__Slice.html) | `slice_test1` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/lax/slice_test1.onnx) | v0.1.0 |
| [lax.sort](https://docs.jax.dev/en/latest/_autosummary/jax.lax.sort.html) | [Sort](https://onnx.ai/onnx/operators/onnx__Sort.html) | `sort` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/lax/sort.onnx) | v0.2.0 |
| [lax.sqrt](https://docs.jax.dev/en/latest/_autosummary/jax.lax.sqrt.html) | [Sqrt](https://onnx.ai/onnx/operators/onnx__Sqrt.html) | `sqrt` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/lax/sqrt.onnx) | v0.2.0 |
| [lax.square](https://docs.jax.dev/en/latest/_autosummary/jax.lax.square.html) | [Mul](https://onnx.ai/onnx/operators/onnx__Mul.html) | `square` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/lax/square.onnx) | v0.2.0 |
| [lax.squeeze](https://docs.jax.dev/en/latest/_autosummary/jax.lax.squeeze.html) | [Squeeze](https://onnx.ai/onnx/operators/onnx__Squeeze.html) | `squeeze` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/lax/squeeze.onnx) | v0.2.0 |
| [lax.stop_gradient](https://docs.jax.dev/en/latest/_autosummary/jax.lax.stop_gradient.html) | [Identity](https://onnx.ai/onnx/operators/onnx__Identity.html) | `stop_gradient` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/lax/stop_gradient.onnx) | v0.2.0 |
| [lax.sub](https://docs.jax.dev/en/latest/_autosummary/jax.lax.sub.html) | [Sub](https://onnx.ai/onnx/operators/onnx__Sub.html) | `sub_test1` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/lax/sub_test1.onnx)<br>`sub_test2` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/lax/sub_test2.onnx) | v0.1.0 |
| [lax.tanh](https://docs.jax.dev/en/latest/_autosummary/jax.lax.tanh.html) | [Tanh](https://onnx.ai/onnx/operators/onnx__Tanh.html) | `tanh` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/lax/tanh.onnx) | v0.2.0 |
| [lax.transpose](https://docs.jax.dev/en/latest/_autosummary/jax.lax.transpose.html) | [Transpose](https://onnx.ai/onnx/operators/onnx__Transpose.html) | `transpose_basic` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/lax/transpose_basic.onnx) | v0.2.0 |
| [nn.softmax](https://jax.readthedocs.io/en/latest/_autosummary/jax.nn.softmax.html) | [Softmax](https://onnx.ai/onnx/operators/onnx__Softmax.html) | `softmax` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/nn/softmax.onnx) | v0.1.0 |
| [nnx.avg_pool](https://jax.readthedocs.io/en/latest/_autosummary/jax.lax.avg_pool.html) | [AveragePool](https://onnx.ai/onnx/operators/onnx__AveragePool.html)<br>[Transpose](https://onnx.ai/onnx/operators/onnx__Transpose.html) | `avg_pool_default_padding` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/nnx/avg_pool_default_padding.onnx)<br>`avg_pool_same_padding` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/nnx/avg_pool_same_padding.onnx)<br>`avg_pool` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/nnx/avg_pool.onnx) | v0.1.0 |
| [nnx.batch_norm](https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/nn/normalization.html#flax.nnx.BatchNorm) | [BatchNormalization](https://onnx.ai/onnx/operators/onnx__BatchNormalization.html) | `batch_norm_2` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/nnx/batch_norm_2.onnx)<br>`batch_norm` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/nnx/batch_norm.onnx) | v0.1.0 |
| [nnx.conv](https://jax.readthedocs.io/en/latest/_autosummary/jax.lax.conv_general_dilated.html) | [Conv](https://onnx.ai/onnx/operators/onnx__Conv.html)<br>[Transpose](https://onnx.ai/onnx/operators/onnx__Transpose.html) | <br>`conv_2` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/nnx/conv_2.onnx)<br>`conv_3` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/nnx/conv_3.onnx)<br>`conv_4` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/nnx/conv_4.onnx)<br>`conv_concrete` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/nnx/conv_concrete.onnx)<br>`conv_dynamic` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/nnx/conv_dynamic.onnx) | v0.1.0 |
| [nnx.dot_product_attention](https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/nn/attention.html#flax.nnx.dot_product_attention) | [Constant](https://onnx.ai/onnx/operators/onnx__Constant.html)<br>[Einsum](https://onnx.ai/onnx/operators/onnx__Einsum.html)<br>[Mul](https://onnx.ai/onnx/operators/onnx__Mul.html)<br>[Softmax](https://onnx.ai/onnx/operators/onnx__Softmax.html) | `dot_product_attention` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/nnx/dot_product_attention.onnx) | v0.1.0 |
| [nnx.dropout](https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/nn/dropout.html) | [Dropout](https://onnx.ai/onnx/operators/onnx__Dropout.html) | `dropout_inference` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/nnx/dropout_inference.onnx) | v0.1.0 |
| [nnx.elu](https://jax.readthedocs.io/en/latest/_autosummary/jax.nn.elu.html) | [Elu](https://onnx.ai/onnx/operators/onnx__Elu.html) | `elu` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/nnx/elu.onnx) | v0.1.0 |
| [nnx.gelu](https://jax.readthedocs.io/en/latest/_autosummary/jax.nn.gelu.html) | [Gelu](https://onnx.ai/onnx/operators/onnx__Gelu.html) | `gelu_1` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/nnx/gelu_1.onnx)<br>`gelu_2` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/nnx/gelu_2.onnx)<br>`gelu_3` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/nnx/gelu_3.onnx)<br>`gelu` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/nnx/gelu.onnx) | v0.1.0 |
| [nnx.layer_norm](https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/nn/layer_norm.html) | [LayerNormalization](https://onnx.ai/onnx/operators/onnx__LayerNormalization.html) | `layer_norm_multiaxis` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/nnx/layer_norm_multiaxis.onnx)<br>`layer_norm` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/nnx/layer_norm.onnx) | v0.1.0 |
| [nnx.leaky_relu](https://jax.readthedocs.io/en/latest/_autosummary/jax.nn.leaky_relu.html) | [LeakyRelu](https://onnx.ai/onnx/operators/onnx__LeakyRelu.html) | `leaky_relu` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/nnx/leaky_relu.onnx) | v0.1.0 |
| [nnx.linear](https://flax.readthedocs.io/en/latest/api_reference/flax.nnx/nn/linear.html) | [Gemm](https://onnx.ai/onnx/operators/onnx__Gemm.html)<br>[Reshape](https://onnx.ai/onnx/operators/onnx__Reshape.html) | <br>`linear_2d` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/nnx/linear_2d.onnx)<br>`linear_concrete` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/nnx/linear_concrete.onnx)<br>`linear_dynamic` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/nnx/linear_dynamic.onnx) | v0.1.0 |
| [nnx.linear_general](https://docs.jax.dev/en/latest/_autosummary/jax.lax.dot_general.html) | [Gemm](https://onnx.ai/onnx/operators/onnx__Gemm.html)<br>[Reshape](https://onnx.ai/onnx/operators/onnx__Reshape.html) | <br>`linear_general_2` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/nnx/linear_general_2.onnx)<br>`linear_general_3` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/nnx/linear_general_3.onnx)<br>`linear_general_4` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/nnx/linear_general_4.onnx)<br>`linear_general_concrete` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/nnx/linear_general_concrete.onnx)<br>`linear_general_dynamic` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/nnx/linear_general_dynamic.onnx) | v0.1.0 |
| [nnx.log_softmax](https://jax.readthedocs.io/en/latest/_autosummary/jax.nn.log_softmax.html) | [LogSoftmax](https://onnx.ai/onnx/operators/onnx__LogSoftmax.html) | `log_softmax` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/nnx/log_softmax.onnx) | v0.1.0 |
| [nnx.max_pool](https://jax.readthedocs.io/en/latest/_autosummary/jax.lax.max_pool.html) | [MaxPool](https://onnx.ai/onnx/operators/onnx__MaxPool.html)<br>[Transpose](https://onnx.ai/onnx/operators/onnx__Transpose.html) | `max_pool_same_padding` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/nnx/max_pool_same_padding.onnx)<br>`max_pool` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/nnx/max_pool.onnx) | v0.1.0 |
| [nnx.relu](https://jax.readthedocs.io/en/latest/_autosummary/jax.nn.relu.html) | [Relu](https://onnx.ai/onnx/operators/onnx__Relu.html) | `relu_2` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/nnx/relu_2.onnx)<br>`relu` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/nnx/relu.onnx) | v0.1.0 |
| [nnx.sigmoid](https://jax.readthedocs.io/en/latest/_autosummary/jax.nnx.sigmoid.html) | [Sigmoid](https://onnx.ai/onnx/operators/onnx__Sigmoid.html) | `sigmoid` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/nnx/sigmoid.onnx) | v0.1.0 |
| [nnx.softmax](https://jax.readthedocs.io/en/latest/_autosummary/jax.nn.softmax.html) | [Softmax](https://onnx.ai/onnx/operators/onnx__Softmax.html) | `softmax` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/nnx/softmax.onnx) | v0.1.0 |
| [nnx.softplus](https://jax.readthedocs.io/en/latest/_autosummary/jax.nn.softplus.html) | [Softplus](https://onnx.ai/onnx/operators/onnx__Softplus.html) | `softplus` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/nnx/softplus.onnx) | v0.1.0 |
| [nnx.tanh](https://jax.readthedocs.io/en/latest/_autosummary/jax.nnx.sigmoid.html) | [Tanh](https://onnx.ai/onnx/operators/onnx__Tanh.html) | `tanh` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/plugins/nnx/tanh.onnx) | v0.1.0 |

<!-- AUTOGENERATED TABLE END -->

**Legend:**  
‚úÖ = Passed  
‚ùå = Failed  
‚ûñ = No testcase yet

---

## üéØ Examples

üöß **Table under construction**

<!-- AUTOGENERATED EXAMPLES TABLE START -->

| Component | Description | Children | Testcases | Since |
|:----------|:------------|:---------|:---------|:------|
| AutoEncoder |  | ‚ûñ | `autoencoder` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/examples/nnx/autoencoder.onnx) | v0.2.0 |
| CNN |  | ‚ûñ | `cnn` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/examples/nnx/cnn.onnx) | v0.1.0 |
| ConvEmbedding |  | ‚ûñ | `mnist_conv_embedding` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/examples/nnx/mnist_conv_embedding.onnx) | v0.1.0 |
| MLP |  | ‚ûñ | <br>`mlp_concrete` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/examples/nnx/mlp_concrete.onnx)<br>`mlp_dynamic` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/examples/nnx/mlp_dynamic.onnx) | v0.1.0 |
| MLPBlock |  | ‚ûñ | `mlp_block` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/examples/nnx/mlp_block.onnx) | v0.1.0 |
| MultiHeadAttention |  | ‚ûñ | `multihead_attention` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/examples/nnx/multihead_attention.onnx) | v0.2.0 |
| PatchEmbedding |  | ‚ûñ | `patch_embedding` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/examples/nnx/patch_embedding.onnx) | v0.1.0 |
| TransformerBlock |  | ‚ûñ | `transformer_block` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/examples/nnx/transformer_block.onnx) | v0.1.0 |
| VisionTransformer |  | ‚ûñ | `mnist_vit_conv` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/examples/nnx/mnist_vit_conv.onnx)<br>`mnist_vit_patch` [‚úÖ](https://netron.app/?url=https://enpasos.github.io/jax2onnx/onnx/examples/nnx/mnist_vit_patch.onnx) | v0.1.0 |

<!-- AUTOGENERATED EXAMPLES TABLE END -->

---

## üìå Dependencies

**Versions of Major Dependencies:**

| Library       | jax2onnx v0.2.0 | 
|:--------------|:----------------| 
| `JAX`         | v0.5.2          | 
| `Flax`        | v0.10.4         | 
| `onnx`        | v1.17.0         |  
| `onnxruntime` | v1.21.0         |  

*Note: For more details, check `pyproject.toml`.*

---

## ‚ö†Ô∏è Limitations

- Currently not all JAX/Flax components are supported (you can easily help expand this coverage!).
- Function references need dynamic resolution at call-time.
- ONNX graph composition is done in-memory before saving to disk, potentially causing memory issues with very large models.

---

## ü§ù How to Contribute

We warmly welcome contributions!

**How you can help:**

- **Add a plugin:** Extend `jax2onnx` by writing a simple Python file in [`jax2onnx/converter/plugins`](./jax2onnx/converter/plugins).
- **Provide examples:** Add an illustrative example to the [`examples`](./jax2onnx/examples) folder.
- **Bug fixes & improvements:** PRs and issues are always welcome.

---

## üíæ Installation

Install from PyPI (soon...):

```bash
pip install jax2onnx  
```

Meanwhile, install the latest development version from TestPyPI:

```bash
pip install -i https://test.pypi.org/simple/ jax2onnx
```

---

## üìú License

This project is licensed under the Apache License, Version 2.0. See [`LICENSE`](./LICENSE) for details.

---

## üåü Special Thanks

Special thanks to the community members involved in:

- [Flax Feature Request #4430](https://github.com/google/flax/issues/4430)
- [JAX Feature Request #26430](https://github.com/jax-ml/jax/issues/26430)

A huge thanks especially to [@limarta](https://github.com/limarta), whose elegant [jaxpr-to-ONNX demonstration](https://gist.github.com/limarta/855a88cc1c0163487a9dc369891147ab) significantly inspired this project.

---

**Happy converting! üéâ**


